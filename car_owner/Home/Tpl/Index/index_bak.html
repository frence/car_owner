<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<meta name="MobileOptimized" content="320" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<title>注册</title>
<link type="text/css" rel="stylesheet" href="{$Think.const.CSS_URL}style.css" />
<style type="text/css">
body{background:#1450ac;}
</style>
<script src="{$Think.const.JS_URL}jquery-1.7.1.min.js"></script>
</head>

<body>
	<div class="register_wrap">
        <form  action="{:U('Index/add')}" method="post">
    	<div class="register_bg"><img src="{$Think.const.IMG_URL}zc_bg.jpg" ></div>
    	<div class="register_content">
        	<div class="register_logo"><img src="{$Think.const.IMG_URL}ylzlogo.png"></div>
            <div class="register_text">易自助洗车</div>
            <div class="register_bd">
            	<input class="sjh" type="text" id="username" name="username" placeholder="中国大陆手机号">
                <input class="re_mm" type="hidden" id="userpassword" name="userpassword" value = "123456">
                <input class="re_mm" type="hidden" id="send_code" name="send_code" value="{$send_code}">
            	<div class="register_yzm_wrap">
                	<input class="re_yzm" type="text" id="verify" name="verify" placeholder="验证码（6位）">
                    <input class="re_btn1" type="button" value="获取验证码" id="zphone" name="zphone"onclick="get_mobile_code()" >
                </div>
                <div class="re_zcbtn">
                    <input type="submit" class="re_zcbtn_ipn" id="submit_btn"  value="注册">
                </div>
            </div>
            <div class="register_xy"><a href="treaty.html">易自助用户协议</a></div>
        </div>
    </form>
    </div>

    <script language="javascript">
    function get_mobile_code(){
        document.getElementById('zphone').disabled = true;
        var tel=$("#username").val();
        var  re = /^0?1[3|4|5|8][0-9]\d{8}$/;
        if (re.test(tel)) {
            $.post('?m=Public&a=SendSMS', {mobile:jQuery.trim($('#username').val()),send_code:jQuery.trim($('#send_code').val())}, function(msg) {
                if(msg==1){
                    alert("短信发送成功，请留意您的手机短信。");
                    RemainTime();
                }else{
                    alert(jQuery.trim(unescape(msg)));
                }
            });
        } else {
            alert("手机号码错误！");
        }
    };
    var iTime = 59;
    var Account;
    function RemainTime(){
        document.getElementById('zphone').disabled = true;
        var iSecond,sSecond="",sTime="";
        if (iTime >= 0){
            iSecond = parseInt(iTime%60);
            iMinute = parseInt(iTime/60)
            if (iSecond >= 0){
                if(iMinute>0){
                    sSecond = iMinute + "分" + iSecond + "秒";
                }else{
                    sSecond = iSecond + "秒";
                }
            }
            sTime=sSecond;
            if(iTime==0){
                clearTimeout(Account);
                sTime='获取手机验证码';
                iTime = 59;
                document.getElementById('zphone').disabled = false;
            }else{
                Account = setTimeout("RemainTime()",1000);
                iTime=iTime-1;
            }
        }else{
            sTime='没有倒计时';
        }
        document.getElementById('zphone').value = sTime;
    }   
</script>
</body>
</html>