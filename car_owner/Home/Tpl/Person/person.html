<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<meta name="MobileOptimized" content="320" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<title>个人中心</title>
<link type="text/css" rel="stylesheet" href="{$Think.const.CSS_URL}style.css" />
<script type="text/javascript" src="{$Think.const.JS_URL}jquery-1.7.1.min.js"></script>
</head>

<body>
	<div class="main">
    		<div class="sj_personal_top">
        	<div class="personal_top_bg"><img src="{$Think.const.IMG_URL}grzx_tbg.jpg"></div>
        	<div class="personal_headpic"><img src="{$Think.const.IMG_URL}grzx_tx.jpg"></div>
        </div>
        <form   action="{:U('Person/passwordbyverify')}" method="post">
            <div class="personal_infor">
            	<div class="personal_zh"><input type="text" placeholder="账号" id="username" name="username" value="{$info['mobile']}"></div>
                <div class="personal_mm"><input type="password" id="newpas" name="newpas" placeholder="修改密码"></div>
                <div class="personal_yzm">
                	<div class="personal_yzm_l"><input class="yz" type="text" placeholder="请输入验证码" id="verify" name="verify"></div>
                    <div class="personal_yzm_r"><input class="hq" type="button" value="获取验证码" id = "zphone" name = "zphone"  onclick="get_mobile_code()"></div>
                </div>
            </div>
<!--             <div class="personal_xmm"><input type="text" id="newpas" name="newpas" placeholder="请输入6位以上新密码" ></div> -->
            <div class="personal_qr"><input type="submit" value="确认"></div>
        </form>
    </div>
    



<script language="javascript">
    function get_mobile_code(){
        var tel=$("#username").val();
        var  re = /^1\d{10}$/;
        if (re.test(tel)) {
            $.post('?m=Person&a=smssend', {mobile:jQuery.trim($('#username').val()),send_code:jQuery.trim($('#send_code').val())}, function(msg) {
                alert(jQuery.trim(unescape(msg)));
                if(msg==1){
                    alert("短信发送成功，请留意您的手机短信。");
                    RemainTime();
                }else{
                    alert(jQuery.trim(unescape(msg)));
                }
            });
        } else {
            alert("手机号码错误！");
        }
    };
    var iTime = 59;
    var Account;
    function RemainTime(){
        document.getElementById('zphone').disabled = true;
        var iSecond,sSecond="",sTime="";
        if (iTime >= 0){
            iSecond = parseInt(iTime%60);
            iMinute = parseInt(iTime/60)
            if (iSecond >= 0){
                if(iMinute>0){
                    sSecond = iMinute + "分" + iSecond + "秒";
                }else{
                    sSecond = iSecond + "秒";
                }
            }
            sTime=sSecond;
            if(iTime==0){
                clearTimeout(Account);
                sTime='获取手机验证码';
                iTime = 59;
                document.getElementById('zphone').disabled = false;
            }else{
                Account = setTimeout("RemainTime()",1000);
                iTime=iTime-1;
            }
        }else{
            sTime='没有倒计时';
        }
        document.getElementById('zphone').value = sTime;
    }   
</script>
</body>
</html>
